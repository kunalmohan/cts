{"version":3,"sources":["../../../src/runtime/helper/test_worker-worker.ts"],"names":["assert","TestLoader","Logger","log","loader","self","onmessage","ev","query","debug","data","files","Array","from","loadTests","length","f","rec","record","id","spec","cases","g","iterate","c","result","run","postMessage"],"mappings":";;;;AAAA,SAASA,MAAT,QAAuB,0BAAvB;AACA,SAASC,UAAT,QAA2B,2BAA3B;AACA,SAASC,MAAT,QAAuB,2BAAvB;AAGuB;AAEvB,MAAMC,GAAG,GAAG,IAAID,MAAJ,EAAZ;AACA,MAAME,MAAM,GAAG,IAAIH,UAAJ,EAAf;;AAEAI,IAAI,CAACC,SAAL,GAAiB,MAAOC,EAAP,IAA4B;AAC3C,QAAM;AAAEC,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAmBF,EAAE,CAACG,IAA5B;AAEA,QAAMC,KAAK,GAAGC,KAAK,CAACC,IAAN,EAAW,MAAMT,MAAM,CAACU,SAAP,CAAiB,CAACN,KAAD,CAAjB,CAAjB,EAAd;AACAR,EAAAA,MAAM,CAACW,KAAK,CAACI,MAAN,KAAiB,CAAlB,EAAqB,qCAArB,CAAN;AAEA,QAAMC,CAAC,GAAGL,KAAK,CAAC,CAAD,CAAf;AACA,QAAM,CAACM,GAAD,IAAQd,GAAG,CAACe,MAAJ,CAAWF,CAAC,CAACG,EAAb,CAAd;AACAnB,EAAAA,MAAM,CAAC,OAAOgB,CAAC,CAACI,IAAV,EAAgB,iCAAhB,CAAN;AAEA,QAAMC,KAAK,GAAGT,KAAK,CAACC,IAAN,CAAWG,CAAC,CAACI,IAAF,CAAOE,CAAP,CAASC,OAAT,CAAiBN,GAAjB,CAAX,CAAd;AACAjB,EAAAA,MAAM,CAACqB,KAAK,CAACN,MAAN,KAAiB,CAAlB,EAAqB,qCAArB,CAAN;AACA,QAAMS,CAAC,GAAGH,KAAK,CAAC,CAAD,CAAf;AAEA,QAAMI,MAAM,GAAG,MAAMD,CAAC,CAACE,GAAF,CAAMjB,KAAN,CAArB;AAEAJ,EAAAA,IAAI,CAACsB,WAAL,CAAiB;AAAEnB,IAAAA,KAAF;AAASiB,IAAAA;AAAT,GAAjB;AACD,CAjBD","sourcesContent":["import { assert } from '../../framework/index.js';\nimport { TestLoader } from '../../framework/loader.js';\nimport { Logger } from '../../framework/logger.js';\n\n// tslint:disable-next-line: no-any\ndeclare var self: any; // should be DedicatedWorkerGlobalScope\n\nconst log = new Logger();\nconst loader = new TestLoader();\n\nself.onmessage = async (ev: MessageEvent) => {\n  const { query, debug } = ev.data;\n\n  const files = Array.from(await loader.loadTests([query]));\n  assert(files.length === 1, 'worker query resulted in != 1 files');\n\n  const f = files[0];\n  const [rec] = log.record(f.id);\n  assert('g' in f.spec, 'worker query resulted in README');\n\n  const cases = Array.from(f.spec.g.iterate(rec));\n  assert(cases.length === 1, 'worker query resulted in != 1 cases');\n  const c = cases[0];\n\n  const result = await c.run(debug);\n\n  self.postMessage({ query, result });\n};\n"],"file":"test_worker-worker.js"}